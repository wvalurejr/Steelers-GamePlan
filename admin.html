<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Steelers GamePlan</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/admin.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h2>üîí Admin Panel</h2>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">üè† Back to App</a>
                </li>
                <li class="nav-item">
                    <button class="theme-toggle" id="theme-toggle">üåô</button>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Login Modal -->
    <div id="login-modal" class="modal-overlay show">
        <div class="modal-content login-modal">
            <h2>üèà Steelers Admin Access</h2>
            <p>Enter the admin password to access team management tools</p>
            <div class="login-form">
                <input type="password" id="admin-password" placeholder="Admin Password" />
                <button class="btn btn-primary" id="login-btn">Access Admin Panel</button>
            </div>
            <div class="login-error" id="login-error" style="display: none;">
                Incorrect password. Please try again.
            </div>
        </div>
    </div>

    <!-- Admin Content (hidden until authenticated) -->
    <main class="admin-content" id="admin-content" style="display: none;">
        <div class="admin-container">
            <h1>üèà East Houma Steelers - Admin Dashboard</h1>

            <!-- Admin Tabs -->
            <div class="admin-tabs">
                <button class="tab-btn active" data-tab="season">üèÜ Season Management</button>
                <button class="tab-btn" data-tab="schedule">üìÖ Schedule & Scores</button>
                <button class="tab-btn" data-tab="teams">üèà Teams & Divisions</button>
                <button class="tab-btn" data-tab="players">üë• Player Stats</button>
                <button class="tab-btn" data-tab="content">üìù Content Management</button>
                <button class="tab-btn" data-tab="settings">‚öôÔ∏è Settings</button>
                <button class="tab-btn" data-tab="archive">üì¶ Archive System</button>
            </div>

            <!-- Season Management Tab -->
            <div class="tab-content active" id="season-tab">
                <div class="admin-section">
                    <h2>üèÜ Season Overview</h2>
                    <div class="season-stats-form">
                        <div class="form-group">
                            <label>Season Year</label>
                            <input type="number" id="season-year" value="2025" min="2020" max="2030" />
                        </div>
                        <div class="form-group">
                            <label>Wins</label>
                            <input type="number" id="season-wins" value="2" min="0" />
                        </div>
                        <div class="form-group">
                            <label>Losses</label>
                            <input type="number" id="season-losses" value="0" min="0" />
                        </div>
                        <div class="form-group">
                            <label>Division Standing</label>
                            <select id="division-standing">
                                <option value="1st Place - East Side Division">1st Place - East Side Division</option>
                                <option value="2nd Place - East Side Division">2nd Place - East Side Division</option>
                                <option value="3rd Place - East Side Division">3rd Place - East Side Division</option>
                                <option value="1st Place - West Side Division">1st Place - West Side Division</option>
                                <option value="2nd Place - West Side Division">2nd Place - West Side Division</option>
                                <option value="3rd Place - West Side Division">3rd Place - West Side Division</option>
                                <option value="Playoff Contender">Playoff Contender</option>
                                <option value="Division Champions">Division Champions</option>
                                <option value="League Champions">League Champions</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Team Motto</label>
                            <input type="text" id="team-motto" value="Steel Strong, Houma Proud!" />
                        </div>
                        <button class="btn btn-primary" id="update-season">Update Season Info</button>
                    </div>
                </div>
            </div>

            <!-- Schedule & Scores Tab -->
            <div class="tab-content" id="schedule-tab">
                <div class="admin-section">
                    <h2>üìÖ Schedule Management</h2>
                    <div class="schedule-controls">
                        <button class="btn btn-primary" id="add-game">+ Add New Game</button>
                        <button class="btn btn-secondary" id="import-schedule">üìÅ Import Schedule</button>
                    </div>

                    <div class="games-management">
                        <h3>Current Season Games</h3>
                        <div id="games-list">
                            <!-- Games will be loaded dynamically -->
                        </div>
                    </div>

                    <!-- Add/Edit Game Modal -->
                    <div id="game-modal" class="modal-overlay" style="display: none;">
                        <div class="modal-content game-modal">
                            <h3 id="game-modal-title">Add New Game</h3>
                            <form id="game-form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Week</label>
                                        <input type="text" id="game-week" placeholder="Week 1" required />
                                    </div>
                                    <div class="form-group">
                                        <label>Date</label>
                                        <input type="date" id="game-date" required />
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Opponent</label>
                                        <select id="game-opponent" required>
                                            <option value="">Select Opponent</option>
                                            <!-- Options will be populated by teams data -->
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Location</label>
                                        <select id="game-location">
                                            <option value="Home">Home</option>
                                            <option value="Away">Away</option>
                                            <option value="Neutral">Neutral Site</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Game Time</label>
                                        <input type="time" id="game-time" />
                                    </div>
                                    <div class="form-group">
                                        <label>Game Status</label>
                                        <select id="game-status">
                                            <option value="upcoming">Upcoming</option>
                                            <option value="completed">Completed</option>
                                            <option value="postponed">Postponed</option>
                                            <option value="playoff">Playoff</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-row score-section" style="display: none;">
                                    <div class="form-group">
                                        <label>Steelers Score</label>
                                        <input type="number" id="steelers-score" min="0" />
                                    </div>
                                    <div class="form-group">
                                        <label>Opponent Score</label>
                                        <input type="number" id="opponent-score" min="0" />
                                    </div>
                                </div>

                                <!-- Game Statistics Section -->
                                <div class="stats-section" style="display: none;">
                                    <h4>üìä Game Statistics</h4>
                                    <div class="form-group">
                                        <label>
                                            <input type="checkbox" id="stats-complete" />
                                            Statistics are complete (uncheck if still gathering stats)
                                        </label>
                                    </div>

                                    <div class="stats-grid">
                                        <div class="stat-category">
                                            <h5>Offensive Stats</h5>
                                            <div class="form-row">
                                                <div class="form-group">
                                                    <label>Total Yards</label>
                                                    <input type="number" id="total-yards" min="0" placeholder="0" />
                                                </div>
                                                <div class="form-group">
                                                    <label>Passing Yards</label>
                                                    <input type="number" id="passing-yards" min="0" placeholder="0" />
                                                </div>
                                            </div>
                                            <div class="form-row">
                                                <div class="form-group">
                                                    <label>Rushing Yards</label>
                                                    <input type="number" id="rushing-yards" min="0" placeholder="0" />
                                                </div>
                                                <div class="form-group">
                                                    <label>Touchdowns</label>
                                                    <input type="number" id="touchdowns" min="0" placeholder="0" />
                                                </div>
                                            </div>
                                        </div>

                                        <div class="stat-category">
                                            <h5>Defensive Stats</h5>
                                            <div class="form-row">
                                                <div class="form-group">
                                                    <label>Tackles</label>
                                                    <input type="number" id="tackles" min="0" placeholder="0" />
                                                </div>
                                                <div class="form-group">
                                                    <label>Interceptions</label>
                                                    <input type="number" id="interceptions" min="0" placeholder="0" />
                                                </div>
                                            </div>
                                            <div class="form-row">
                                                <div class="form-group">
                                                    <label>Fumble Recoveries</label>
                                                    <input type="number" id="fumble-recoveries" min="0"
                                                        placeholder="0" />
                                                </div>
                                                <div class="form-group">
                                                    <label>Sacks</label>
                                                    <input type="number" id="sacks" min="0" placeholder="0" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Game Highlights/Notes</label>
                                    <textarea id="game-highlights" rows="3"
                                        placeholder="Game summary, key plays, standout performances..."></textarea>
                                </div>
                                <div class="form-group">
                                    <label>
                                        <input type="checkbox" id="show-score" />
                                        Show score publicly (uncheck to hide from public view)
                                    </label>
                                </div>
                                <div class="modal-actions">
                                    <button type="submit" class="btn btn-primary" id="save-game">Save Game</button>
                                    <button type="button" class="btn btn-secondary" id="cancel-game">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Player Stats Tab -->
            <div class="tab-content" id="players-tab">
                <div class="admin-section">
                    <h2>üë• Player Statistics</h2>
                    <div class="players-controls">
                        <button class="btn btn-primary" id="add-player">+ Add Player</button>
                        <button class="btn btn-secondary" id="import-roster">üìÅ Import Roster</button>
                    </div>

                    <div class="players-grid" id="players-grid">
                        <!-- Players will be loaded dynamically -->
                    </div>

                    <!-- Add/Edit Player Modal -->
                    <div id="player-modal" class="modal-overlay" style="display: none;">
                        <div class="modal-content player-modal">
                            <h3 id="player-modal-title">Add Player</h3>
                            <form id="player-form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Player Name</label>
                                        <input type="text" id="player-name" placeholder="First Last" required />
                                    </div>
                                    <div class="form-group">
                                        <label>Jersey Number</label>
                                        <input type="number" id="player-number" min="0" max="99" required />
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Position</label>
                                        <input type="text" id="player-position" placeholder="QB, RB, WR, etc." />
                                    </div>
                                    <div class="form-group">
                                        <label>Grade</label>
                                        <select id="player-grade">
                                            <option value="5th">5th Grade</option>
                                            <option value="6th">6th Grade</option>
                                            <option value="7th">7th Grade</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="stats-section">
                                    <h4>Season Statistics</h4>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Touchdowns</label>
                                            <input type="number" id="player-tds" min="0" value="0" />
                                        </div>
                                        <div class="form-group">
                                            <label>Yards</label>
                                            <input type="number" id="player-yards" min="0" value="0" />
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Tackles</label>
                                            <input type="number" id="player-tackles" min="0" value="0" />
                                        </div>
                                        <div class="form-group">
                                            <label>Interceptions</label>
                                            <input type="number" id="player-ints" min="0" value="0" />
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-actions">
                                    <button type="submit" class="btn btn-primary">Save Player</button>
                                    <button type="button" class="btn btn-secondary" id="cancel-player">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Teams & Divisions Tab -->
            <div class="tab-content" id="teams-tab">
                <div class="admin-section">
                    <h2>üèà Teams & Divisions Management</h2>

                    <div class="teams-overview">
                        <div class="division-info">
                            <h3>League Structure</h3>
                            <p>The league consists of two divisions:</p>
                            <ul>
                                <li><strong>East Side Division</strong></li>
                                <li><strong>West Side Division</strong></li>
                            </ul>
                        </div>
                    </div>

                    <div class="teams-controls">
                        <button class="btn btn-primary" id="add-east-team">+ Add East Side Team</button>
                        <button class="btn btn-primary" id="add-west-team">+ Add West Side Team</button>
                        <button class="btn btn-secondary" id="import-teams">üìÅ Import Teams</button>
                    </div>

                    <div class="teams-management">
                        <div class="division-section">
                            <h3>East Side Division</h3>
                            <div class="teams-grid east-side" id="east-teams">
                                <!-- East Side teams will be loaded dynamically -->
                            </div>
                        </div>

                        <div class="division-section">
                            <h3>West Side Division</h3>
                            <div class="teams-grid west-side" id="west-teams">
                                <!-- West Side teams will be loaded dynamically -->
                            </div>
                        </div>
                    </div>

                    <!-- Add/Edit Team Modal -->
                    <div id="team-modal" class="modal-overlay" style="display: none;">
                        <div class="modal-content team-modal">
                            <h3 id="team-modal-title">Add New Team</h3>
                            <form id="team-form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Team Name</label>
                                        <input type="text" id="team-name" placeholder="Thibodaux Tigers" required />
                                    </div>
                                    <div class="form-group">
                                        <label>Division</label>
                                        <select id="team-division" required>
                                            <option value="">Select Division</option>
                                            <option value="East Side">East Side Division</option>
                                            <option value="West Side">West Side Division</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Team Colors (Primary)</label>
                                        <input type="color" id="team-primary-color" value="#000000" />
                                    </div>
                                    <div class="form-group">
                                        <label>Team Colors (Secondary)</label>
                                        <input type="color" id="team-secondary-color" value="#ffffff" />
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Home Field/Location</label>
                                        <input type="text" id="team-location"
                                            placeholder="Thibodaux Community Center" />
                                    </div>
                                    <div class="form-group">
                                        <label>Coach Name</label>
                                        <input type="text" id="team-coach" placeholder="Coach Johnson" />
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Team Notes</label>
                                    <textarea id="team-notes" rows="3"
                                        placeholder="Additional information about the team..."></textarea>
                                </div>
                                <div class="modal-actions">
                                    <button type="submit" class="btn btn-primary" id="save-team">Save Team</button>
                                    <button type="button" class="btn btn-secondary" id="cancel-team">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content Management Tab -->
            <div class="tab-content" id="content-tab">
                <div class="admin-section">
                    <h2>üìù Content Management</h2>

                    <div class="content-section">
                        <h3>Welcome Message</h3>
                        <div class="form-group">
                            <label>Hero Title</label>
                            <input type="text" id="hero-title" value="üèÜ Welcome Steelers! üèÜ" />
                        </div>
                        <div class="form-group">
                            <label>Hero Subtitle</label>
                            <textarea id="hero-subtitle"
                                rows="4">The Steelers organization believes that collaboration makes all things better. This GamePlan tool empowers our coaching staff to design, share, and perfect plays together - because great teams are built on great teamwork.</textarea>
                        </div>
                        <div class="form-group">
                            <label>Coach Greeting</label>
                            <input type="text" id="coach-greeting"
                                value="Let's create championship plays together! ü•á" />
                        </div>
                    </div>

                    <div class="content-section">
                        <h3>Feature Cards</h3>
                        <div id="feature-cards-editor">
                            <!-- Feature cards will be loaded dynamically -->
                        </div>
                        <button class="btn btn-primary" id="add-feature-card">+ Add Feature Card</button>
                    </div>

                    <div class="content-section">
                        <h3>Season Highlights</h3>
                        <div class="form-group">
                            <label>Current Highlights</label>
                            <textarea id="season-highlights" rows="6"
                                placeholder="Enter key highlights for this season..."></textarea>
                        </div>
                    </div>

                    <button class="btn btn-primary" id="update-content">Update Content</button>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-content" id="settings-tab">
                <div class="admin-section">
                    <h2>‚öôÔ∏è Application Settings</h2>

                    <div class="settings-section">
                        <h3>Security</h3>
                        <div class="form-group">
                            <label>Change Admin Password</label>
                            <div class="password-change">
                                <input type="password" id="current-password" placeholder="Current Password" />
                                <input type="password" id="new-password" placeholder="New Password" />
                                <input type="password" id="confirm-password" placeholder="Confirm New Password" />
                                <button class="btn btn-secondary" id="change-password">Change Password</button>
                            </div>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>Display Options</h3>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="show-player-stats" checked />
                                Show player statistics on homepage
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="show-schedule" checked />
                                Show schedule on homepage
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="public-scores" checked />
                                Show scores publicly by default
                            </label>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>Data Management</h3>
                        <div class="data-actions">
                            <button class="btn btn-secondary" id="export-data">üì§ Export All Data</button>
                            <button class="btn btn-secondary" id="backup-data">üíæ Create Backup</button>
                            <button class="btn btn-danger" id="clear-cache">üóëÔ∏è Clear Cache</button>
                        </div>
                    </div>

                    <button class="btn btn-primary" id="save-settings">Save Settings</button>
                </div>
            </div>

            <!-- Archive System Tab -->
            <div class="tab-content" id="archive-tab">
                <div class="admin-section">
                    <h2>üì¶ Season Archive System</h2>

                    <div class="archive-section">
                        <h3>Current Season</h3>
                        <div class="current-season-info">
                            <div class="season-summary">
                                <h4>2025 Season Summary</h4>
                                <p><strong>Record:</strong> <span id="archive-record">2-0</span></p>
                                <p><strong>Games Played:</strong> <span id="archive-games">2</span></p>
                                <p><strong>Players:</strong> <span id="archive-players">0</span></p>
                                <p><strong>Plays in Library:</strong> <span id="archive-plays">0</span></p>
                            </div>
                        </div>
                    </div>

                    <div class="archive-section">
                        <h3>Archive Actions</h3>
                        <div class="archive-warning">
                            <h4>‚ö†Ô∏è Archive Current Season</h4>
                            <p>Archiving will:</p>
                            <ul>
                                <li>Save all current season data to archive</li>
                                <li>Reset schedule for new season</li>
                                <li>Clear current player stats (preserve roster)</li>
                                <li>Keep play library intact</li>
                                <li>Reset win/loss record to 0-0</li>
                            </ul>
                            <div class="form-group">
                                <label>Archive Name</label>
                                <input type="text" id="archive-name" placeholder="2025 Championship Season" />
                            </div>
                            <button class="btn btn-warning" id="archive-season">üì¶ Archive Season</button>
                        </div>
                    </div>

                    <div class="archive-section">
                        <h3>Previous Seasons</h3>
                        <div id="archived-seasons">
                            <!-- Archived seasons will be loaded dynamically -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Firebase CDN -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <!-- Admin Scripts -->
    <script src="js/firebase-service.js"></script>
    <script src="js/admin.js"></script>

    <!-- Initialize Admin -->
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('Admin page DOMContentLoaded event fired');

            // Check if required elements exist
            const loginModal = document.getElementById('login-modal');
            const adminContent = document.getElementById('admin-content');

            console.log('Login modal found:', !!loginModal);
            console.log('Admin content found:', !!adminContent);

            // Initialize Firebase if available
            if (location.protocol !== 'file:' && typeof firebase !== 'undefined') {
                try {
                    const firebaseService = FirebaseService.getInstance();
                    await firebaseService.initialize();
                    console.log('Firebase initialized for admin');
                } catch (error) {
                    console.warn('Firebase initialization failed:', error);
                }
            }

            // Check if AdminPanel class is available
            if (typeof AdminPanel === 'undefined') {
                console.error('AdminPanel class not found! Check if admin.js loaded properly.');
                return;
            }

            console.log('Creating AdminPanel instance...');
            // Initialize admin panel
            window.adminPanel = new AdminPanel();
            console.log('AdminPanel instance created successfully');
        });
    </script>
</body>

</html>